shallow_clone: true

platform:
  # - x86
  - x64

configuration:
  # - Debug
  - Release

image:
  - Visual Studio 2019

branches:
  except:
    - linux
    - macos

install:
  - cmd: call 'C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat' %PLATFORM%
  - cmd: git submodule update --init --recursive

build_script:
  - cmd: set CC=clang-cl
  - cmd: set CXX=clang-cl
  - cmd: mkdir build
  - cmd: meson setup --buildtype release --optimization 3 build
  - cmd: cd build
  - cmd: ninja
  - cmd: ninja test

test: off

# Uncomment to enable rdp.
# on_finish:
#   - ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
